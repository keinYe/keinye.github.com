I"³3<p>Alembic æ˜¯ä¸€æ¬¾è½»é‡å‹çš„æ•°æ®åº“è¿ç§»å·¥å…·ï¼Œå®ƒä¸ <a href="https://mp.weixin.qq.com/s/QF41i58djnn-Hb6n8vbjew">SQLAlchemy</a> ä¸€èµ·å…±åŒä¸º Python æä¾›æ•°æ®åº“ç®¡ç†ä¸è¿ç§»æ”¯æŒã€‚</p>

<h2 id="alembic-çš„åº”ç”¨">Alembic çš„åº”ç”¨</h2>
<p>Alembic ä½¿ç”¨ SQLAlchemy ä½œä¸ºæ•°æ®åº“å¼•æ“ï¼Œä¸ºå…³ç³»å‹æ•°æ®æä¾›åˆ›å»ºã€ç®¡ç†ã€æ›´æ”¹å’Œè°ƒç”¨çš„ç®¡ç†è„šæœ¬ï¼ŒååŠ©å¼€å‘å’Œè¿ç»´äººå‘˜åœ¨ç³»ç»Ÿä¸Šçº¿åå¯¹æ•°æ®åº“è¿›è¡Œåœ¨çº¿ç®¡ç†ã€‚</p>

<p>åŒä»»ä½• Python æ‰©å±•åº“ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ pip æ¥å¿«é€Ÿçš„å®‰è£…æœ€æ–°çš„ç¨³å®šç‰ˆ Alembic æ‰©å±•åº“ <code>pip install alembic</code>ã€‚</p>

<h3 id="åˆ›å»º-alembic-è¿ç§»ç¯å¢ƒ">åˆ›å»º Alembic è¿ç§»ç¯å¢ƒ</h3>
<p>åœ¨ä½¿ç”¨ Alembic ä¹‹å‰éœ€è¦å…ˆå»ºç«‹ä¸€ä¸ª Alembic è„šæœ¬ç¯å¢ƒï¼Œé€šè¿‡åœ¨å·¥ç¨‹ç›®å½•ä¸‹è¾“å…¥  <code>alembic init alembic</code> å‘½ä»¤å¯ä»¥å¿«é€Ÿåœ¨åº”ç”¨ç¨‹åºä¸­å»ºç«‹ Alembic è„šæœ¬ç¯å¢ƒï¼Œå½“åœ¨å‘½ä»¤è¡Œçœ‹åˆ°ä»¥ä¸‹è¾“å‡ºæ—¶ï¼Œè¡¨ç¤º alembic è„šæœ¬ç¯å¢ƒåˆ›å»ºå®Œæˆã€‚</p>
<pre><code class="language-shell">(.venv) âœ  server alembic init alembic
  Creating directory /&lt;path&gt;/alembic ...  done
  Creating directory /&lt;path&gt;/versions ...  done
  Generating /&lt;path&gt;/alembic/script.py.mako ...  done
  Generating /&lt;path&gt;/alembic/env.py ...  done
  Generating /&lt;path&gt;/alembic/README ...  done
  Generating /&lt;path&gt;/alembic.ini ...  done
  Please edit configuration/connection/logging settings in '/Users/keinYe/Work/python/server/alembic.ini' before proceeding.
</code></pre>
<p>ä½ å¯ä»¥é€šè¿‡ -t é€‰é¡¹æ¥é€‰æ‹©ä¸€ä¸ªåˆå§‹åŒ–çš„æ¨¡æ¿ï¼ŒAlembic ç›®å‰æ”¯æŒä¸‰ä¸ªåˆå§‹åŒ–æ¨¡æ¿ã€Œé€šè¿‡ <code>alembic list_templates</code> å¯ä»¥æŸ¥çœ‹æ”¯æŒçš„æ¨¡æ¿ç±»å‹ã€ï¼Œé»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨çš„æ˜¯é€šç”¨æ¨¡æ¿ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä½¿ç”¨é€šç”¨æ¨¡æ¿å³å¯ã€‚</p>

<p>ç”Ÿæˆçš„è¿ç§»è„šæœ¬ç›®å½•å¦‚ä¸‹ï¼š</p>
<pre><code class="language-shell">â”œâ”€â”€ alembic
â”‚Â Â  â”œâ”€â”€ README
â”‚Â Â  â”œâ”€â”€ env.py
â”‚Â Â  â”œâ”€â”€ script.py.mako
â”‚Â Â  â””â”€â”€ versions
</code></pre>
<ul>
  <li><strong>alembic ç›®å½•</strong>ï¼šè¿ç§»è„šæœ¬çš„æ ¹ç›®å½•ï¼Œæ”¾ç½®åœ¨åº”ç”¨ç¨‹åºçš„æ ¹ç›®å½•ä¸‹ï¼Œå¯ä»¥è®¾ç½®ä¸ºä»»æ„åç§°ã€‚åœ¨å¤šæ•°æ®åº“åº”ç”¨ç¨‹åºå¯ä»¥ä¸ºæ¯ä¸ªæ•°æ®åº“å•ç‹¬è®¾ç½®ä¸€ä¸ª Alembic è„šæœ¬ç›®å½•ã€‚</li>
  <li><strong>README æ–‡ä»¶</strong>ï¼šè¯´æ˜æ–‡ä»¶ï¼Œåˆå§‹åŒ–å®Œæˆæ—¶æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ã€‚</li>
  <li><strong>env.py æ–‡ä»¶</strong>ï¼šä¸€ä¸ª python æ–‡ä»¶ï¼Œåœ¨è°ƒç”¨ Alembic å‘½ä»¤æ—¶è¯¥è„šæœ¬æ–‡ä»¶è¿è¡Œã€‚</li>
  <li><strong>script.py.mako æ–‡ä»¶</strong>ï¼šæ˜¯ä¸€ä¸ª mako æ¨¡æ¿æ–‡ä»¶ï¼Œç”¨äºç”Ÿæˆæ–°çš„è¿ç§»è„šæœ¬æ–‡ä»¶ã€‚</li>
  <li><strong>versions ç›®å½•</strong>ï¼šç”¨äºå­˜æ”¾å„ä¸ªç‰ˆæœ¬çš„è¿ç§»è„šæœ¬ã€‚åˆå§‹æƒ…å†µä¸‹ä¸ºç©ºç›®å½•ï¼Œé€šè¿‡ <code>revision</code> å‘½ä»¤å¯ä»¥ç”Ÿæˆæ–°çš„è¿ç§»è„šæœ¬ã€‚</li>
</ul>

<blockquote>
  <p>alembic ä¼šåœ¨ä½ çš„åº”ç”¨ç¨‹åºçš„æ ¹ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª <code>alembic.ini</code> çš„é…ç½®æ–‡ä»¶ï¼Œåœ¨å¼€å§‹ä»»ä½•çš„æ“ä½œä¹‹å‰éœ€è¦å…ˆä¿®æ”¹è¯¥æ–‡ä»¶ä¸­çš„ <code>sqlalchemy.url</code> æŒ‡å‘ä½ è‡ªå·±çš„æ•°æ®åº“åœ°å€ã€‚</p>
</blockquote>

<h3 id="ç”Ÿæˆè¿ç§»è„šæœ¬">ç”Ÿæˆè¿ç§»è„šæœ¬</h3>
<p>å½“ Alembic é…ç½®ç¯å¢ƒåˆ›å»ºå®Œæˆåï¼Œå¯ä»¥é€šè¿‡ Alembic çš„å­å‘½ä»¤ revision æ¥ç”Ÿæˆæ–°çš„è¿ç§»è„šæœ¬ã€‚</p>
<pre><code class="language-shell">(.venv) âœ  server alembic revision -m "first create script"
  Generating /&lt;path&gt;/alembic/versions/4d1cbe22bfc6_first_
  create_script.py ...  done
</code></pre>
<p>åˆå§‹çš„è¿ç§»è„šæœ¬ä¸­å¹¶æ²¡æœ‰å®é™…æœ‰æ•ˆçš„å†…å®¹ï¼Œç›¸å½“äºä¸€ä¸ªç©ºç™½çš„æ¨¡æ¿æ–‡ä»¶ã€Œå¢åŠ äº†ç‰ˆæœ¬ä¿¡æ¯ã€ã€‚å¦‚æœå¯¹æ•´æ”¹å·¥ç¨‹çš„æ•°æ®è¡¨è¿›è¡Œä¿®æ”¹åï¼Œå†æ¬¡è¿è¡Œ revision å­å‘½ä»¤å¯ä»¥çœ‹åˆ°æ–°ç”Ÿæˆçš„è„šæœ¬æ–‡ä»¶ä¸­çš„å†…å®¹å¢åŠ äº†æˆ‘ä»¬å¯¹æ•°æ®è¡¨çš„æ”¹å˜å†…å®¹ã€‚</p>
<pre><code class="language-shell">(.venv) âœ  server alembic revision -m "add create date in user table"
  Generating /&lt;path&gt;/alembic/versions/fc540ca3e448_add_create_date_in
  _user_table.py ...  done
</code></pre>
<p>æ­¤æ—¶åœ¨ alembic æ–‡ä»¶å¤¹ä¸­å¯ä»¥çœ‹åˆ°ä»¥ä¸‹æ–‡ä»¶:</p>
<pre><code class="language-shell">alembic
â”œâ”€â”€ README
â”œâ”€â”€ env.py
â”œâ”€â”€ script.py.mako
â””â”€â”€ versions
    â”œâ”€â”€ 3602707b314b_first_create_script.py
    â””â”€â”€ eac6fb06ced5_add_create_date_in_user_table.py
</code></pre>
<p>å¯ä»¥çœ‹åˆ°åœ¨ versions ç›®å½•ä¸­ç”Ÿæˆäº†ä¸¤ä¸ªè¿ç§»è„šæœ¬æ–‡ä»¶ï¼Œä½†æ˜¯æ­¤æ—¶çš„è¿ç§»è„šæœ¬æ–‡ä»¶ä¸­æ²¡æœ‰ä»»ä½•çš„æœ‰æ•ˆä»£ç ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">"""add create date in user table
Revision ID: eac6fb06ced5
Revises: 3602707b314b
Create Date: 2019-11-03 06:54:23.862575
"""
from alembic import op
import sqlalchemy as sa
# revision identifiers, used by Alembic.
revision = 'eac6fb06ced5'
down_revision = '3602707b314b'
branch_labels = None
depends_on = None
def upgrade():
    pass
def downgrade():
    pass
</code></pre>
<p>åœ¨è¯¥æ–‡ä»¶ä¸­åˆ¶å®šäº†å½“å‰ç‰ˆæœ¬å· <code>revision</code> å’Œçˆ¶ç‰ˆæœ¬å· <code>down_revision</code> ï¼Œä»¥åŠç›¸åº”çš„å‡çº§æ“ä½œå‡½æ•° <code>upgrade</code> å’Œé™çº§æ“ä½œå‡½æ•° <code>dwongrade</code>ã€‚åœ¨ <code>upgrade</code> å’Œ <code>dwongrade</code> å‡½æ•°ä¸­é€šè¿‡ç›¸åº”çš„ API æ¥æ“ä½œ op å’Œ sa å¯¹è±¡æ¥å®Œæˆå¯¹æ•°æ®åº“çš„ä¿®æ”¹ï¼Œä»¥ä¸‹ä»£ç å®Œæˆäº†åœ¨æ•°æ®åº“ä¸­æ–°å¢ä¸€ä¸ª account æ•°æ®è¡¨çš„åŠŸèƒ½ã€‚</p>
<pre><code class="language-python">def upgrade():
    op.create_table(
        'account',
        sa.Column('id', sa.Integer, primary_key=True),
        sa.Column('name', sa.String(50), nullable=False),
        sa.Column('description', sa.Unicode(200)),
    )
def downgrade():
    op.drop_table('account')
</code></pre>
<p>æ¯æ¬¡ç¼–å†™å®Œä»£ç è¿˜éœ€è¦æ‰‹åŠ¨ç¼–å†™è¿ç§»è„šæœ¬è¿™å¹¶ä¸æ˜¯ç¨‹åºå‘˜æ‰€éœ€è¦çš„ï¼Œå¹¸è¿çš„æ˜¯ Alembic çš„å¼€å‘è€…ä¸ºç¨‹åºå‘˜æä¾›äº†æ›´ç¾å¥½çš„æ“ä½œã€Œè‡ªåŠ¨ç”Ÿæˆè¿ç§»è„šæœ¬ã€ã€‚è‡ªåŠ¨ç”Ÿæˆè¿ç§»è„šæœ¬æ— éœ€è€ƒè™‘æ•°æ®åº“ç›¸å…³æ“ä½œï¼Œåªéœ€å®Œæˆ ROM ä¸­ç›¸å…³ç±»çš„ç¼–å†™å³å¯ï¼Œé€šè¿‡ Alembic å‘½ä»¤å³å¯åœ¨æ•°æ®åº“ä¸­è‡ªåŠ¨å®Œæˆæ•°æ®è¡¨çš„ç”Ÿæˆå’Œæ›´æ–°ã€‚åœ¨ Alembic ä¸­é€šè¿‡ revision å­å‘½ä»¤çš„ â€“autogrenerate é€‰é¡¹å‚æ•°æ¥ç”Ÿæˆè‡ªåŠ¨è¿ç§»è„šæœ¬ã€‚</p>

<p>åœ¨ä½¿ç”¨è‡ªåŠ¨ç”Ÿæˆå‘½ä»¤ä¹‹å‰ï¼Œéœ€è¦åœ¨ env.py æ–‡ä»¶ä¸­ä¿®æ”¹ target_metadata é…ç½®ä½¿å…¶æŒ‡å‘åº”ç”¨ç¨‹åºä¸­çš„å…ƒæ•°æ®å¯¹è±¡ã€‚</p>
<pre><code class="language-python"># add your model's MetaData object here
# for 'autogenerate' support
# from myapp import mymodel
# target_metadata = mymodel.Base.metadata
# target_metadata = None
from server.module import metadata
target_metadata = metadata
</code></pre>

<p>åœ¨ user æ•°æ®è¡¨ä¸­æ–°å¢ create_date æ•°æ®åˆ—ï¼Œç„¶åä½¿ç”¨è‡ªåŠ¨ç”Ÿæˆè¿ç§»è„šæœ¬å‘½ä»¤ï¼ŒæŸ¥çœ‹æˆ‘ä»¬çš„é…ç½®æ˜¯å¦å®Œæˆã€‚è¿è¡Œå‘½ä»¤åå¯ä»¥çœ‹åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<pre><code class="language-shell">(.venv) âœ  server alembic revision --autogenerate -m 'add create date in user table'
INFO  [alembic.runtime.migration] Context impl SQLiteImpl.
INFO  [alembic.runtime.migration] Will assume non-transactional DDL.
INFO  [alembic.autogenerate.compare] Detected added column 'user.create_date'
  Generating /&lt;path&gt;/alembic/versions/476cb25a3138_add_create_date_in_user_table.py ...  done
</code></pre>
<p>ç”Ÿæˆçš„è¿ç§»è„šæœ¬æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.add_column('user', sa.Column('create_date', sa.DateTime(), nullable=True))
    # ### end Alembic commands ###

def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_column('user', 'create_date')
    # ### end Alembic commands ###
</code></pre>

<p>åœ¨è‡ªåŠ¨ç”Ÿæˆè¿ç§»è„šæœ¬çš„è¿‡ç¨‹ä¸­ä½ å¯èƒ½ä¼šé‡åˆ°ä»¥ä¸‹é”™è¯¯</p>
<pre><code class="language-shell">(.venv) âœ  server alembic revision --autogenerate
INFO  [alembic.runtime.migration] Context impl SQLiteImpl.
INFO  [alembic.runtime.migration] Will assume non-transactional DDL.
ERROR [alembic.util.messaging] Target database is not up to date.
  FAILED: Target database is not up to date.
</code></pre>
<p>å‡ºç°è¯¥é”™è¯¯çš„åŸå› æ˜¯æ²¡æœ‰ä½¿ç”¨ Alembic æ›´æ–°æ•°æ®åº“ï¼Œå¦‚æœä½ æ²¡æœ‰æ‰‹åŠ¨åˆ›å»ºæ•°æ®è¡¨å¯ä»¥ä½¿ç”¨ <code>alembic upgrade head</code> å‘½ä»¤æ¶ˆé™¤è¯¥é”™è¯¯ï¼Œå¦‚æœä½ å·²ç»é€šè¿‡å‘½ä»¤è¡Œæˆ–å…¶ä»–æ–¹å¼åˆ›å»ºäº†æ•°æ®è¡¨ï¼Œå¯ä»¥ä½¿ç”¨ <code>alembic stamp head</code> å‘½ä»¤æ¥è®¾ç½® Alembic çš„çŠ¶æ€ã€‚</p>

<h3 id="å˜æ›´æ•°æ®åº“">å˜æ›´æ•°æ®åº“</h3>
<p>Alembic æœ€é‡è¦çš„åŠŸèƒ½æ˜¯è‡ªåŠ¨å®Œæˆæ•°æ®åº“çš„è¿ç§»ã€Œå˜æ›´ã€ï¼Œæ‰€åšçš„é…ç½®ä»¥åŠç”Ÿæˆçš„è„šæœ¬æ–‡ä»¶éƒ½æ˜¯ä¸ºæ•°æ®çš„è¿ç§»åšå‡†å¤‡çš„ï¼Œæ•°æ®åº“çš„è¿ç§»ä¸»è¦ç”¨åˆ° <code>upgrade</code> å’Œ <code>downgrade</code> å­å‘½ä»¤ã€‚</p>

<p>æ•°æ®çœ‹çš„å˜æ›´ä¸»è¦ç”¨åˆ°ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<ul>
  <li><strong><code>alembic upgrade head</code></strong>ï¼šå°†æ•°æ®åº“å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚</li>
  <li><strong><code>alembic downgrade base</code></strong>ï¼šå°†æ•°æ®åº“é™çº§åˆ°æœ€åˆç‰ˆæœ¬ã€‚</li>
  <li><strong><code>alembic upgrade &lt;version&gt;</code></strong>ï¼šå°†æ•°æ®åº“å‡çº§åˆ°æŒ‡å®šç‰ˆæœ¬ã€‚</li>
  <li><strong><code>alembic downgrade &lt;version&gt;</code></strong>ï¼šå°†æ•°æ®åº“é™çº§åˆ°æŒ‡å®šç‰ˆæœ¬ã€‚</li>
  <li><strong><code>alembic upgrade +2</code></strong>ï¼šç›¸å¯¹å‡çº§ï¼Œå°†æ•°æ®åº“å‡çº§åˆ°å½“å‰ç‰ˆæœ¬åçš„ä¸¤ä¸ªç‰ˆæœ¬ã€‚</li>
  <li><strong><code>alembic downgrade +2</code></strong>ï¼šç›¸å¯¹é™çº§ï¼Œå°†æ•°æ®åº“é™çº§åˆ°å½“å‰ç‰ˆæœ¬å‰çš„ä¸¤ä¸ªç‰ˆæœ¬ã€‚</li>
</ul>

<p>ä»¥ä¸Šæ‰€æœ‰çš„å‡é™çº§æ–¹å¼éƒ½æ˜¯åœ¨çº¿æ–¹å¼å®æ—¶æ›´æ–°æ•°æ®åº“æ–‡ä»¶ï¼Œå®é™…ç¯å¢ƒä¸­æ€»ä¼šå­˜åœ¨ä¸€äº›ç¯å¢ƒæ— æ³•åœ¨çº¿å‡çº§ï¼ŒAlembic æä¾›äº†ç”Ÿæˆ SQL è„šæœ¬çš„å½¢å¼ï¼Œå·²æä¾›ç¦»çº¿å‡é™çº§çš„åŠŸèƒ½ã€‚</p>
<pre><code class="language-shell">alembic upgrade &lt;version&gt; --sql &gt; migration.sql
</code></pre>
<p>æˆ–</p>
<pre><code class="language-shell">alembic downgrade &lt;version&gt; --sql &gt; migration.sql
</code></pre>

<p>éšç€é¡¹ç›®çš„è¿›å±•ï¼Œé¡¹ç›®ä¸‹ä¸å¯é¿å…çš„ä¼šç”Ÿæˆå¾ˆå¤šç‰ˆæœ¬çš„è¿ç§»è„šæœ¬ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨ <code>current</code> æ¥æŸ¥çœ‹çº¿ä¸Šæ•°æ®åº“å¤„äºä»€ä¹ˆç‰ˆæœ¬ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ <code>history</code> æ¥æŸ¥çœ‹é¡¹ç›®ç›®å½•ä¸­çš„è¿ç§»è„šæœ¬ä¿¡æ¯ã€‚</p>
<pre><code class="language-shell">(.venv) âœ  server alembic current
INFO  [alembic.runtime.migration] Context impl SQLiteImpl.
INFO  [alembic.runtime.migration] Will assume non-transactional DDL.
71fe19b20211
(.venv) âœ  server alembic history --verbose
Rev: 476cb25a3138 (head)
Parent: 71fe19b20211
Path: /&lt;path&gt;/alembic/versions/476cb25a3138_add_create_date_in_user_table.py

    add create date in user table

    Revision ID: 476cb25a3138
    Revises: 71fe19b20211
    Create Date: 2019-11-03 07:20:23.594777

Rev: 71fe19b20211
Parent: &lt;base&gt;
Path: /&lt;path&gt;/alembic/versions/71fe19b20211_crate_user_table.py

    crate user table

    Revision ID: 71fe19b20211
    Revises:
    Create Date: 2019-11-03 07:19:03.221662
</code></pre>

<h2 id="åœ¨-flask-ä¸­ä½¿ç”¨-alembic">åœ¨ Flask ä¸­ä½¿ç”¨ Alembic</h2>
<p>åœ¨ Flask å¯ä»¥é€šè¿‡ Flask-Migrate å¿«é€Ÿé›†æˆ Alembic çš„æ”¯æŒã€‚</p>

<blockquote>
  <p>Flask-Migrate æ˜¯ä½¿ç”¨ Alembic å¤„ç† Flask åº”ç”¨ä¸­æ•°æ®åº“ã€Œä½¿ç”¨ SQLAlchemy ORMã€è¿ç§»çš„æ‰©å±•åº“ã€‚å…¶å†…ç½®äº† Click å‘½ä»¤è¡Œç¨‹åºï¼Œåœ¨ Flask ä¸Šå¯ç›´æ¥ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·è¿›è¡Œæ•°æ®åº“çš„è¿ç§»ã€‚å…³äº Click çš„ä½¿ç”¨è¯·å‚è€ƒ <a href="https://mp.weixin.qq.com/s/YQduuNZ1Grs2NeblazCt9g">Python å‘½ä»¤è¡Œç¥å™¨ Click</a>ã€‚</p>
</blockquote>

<p>Flask-Migrate æ”¯æŒä½¿ç”¨ pip è¿›è¡Œå®‰è£…ï¼š</p>
<pre><code class="language-shell">pip install flask-migrate
</code></pre>
<p>Flask-Migrate å®‰è£…å®Œæˆåï¼Œä¼šåœ¨ Flask åº”ç”¨ç¨‹åºçš„å‘½ä»¤ä¸‹è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª db å­å‘½ä»¤ï¼Œæˆ‘ä»¬é€šè¿‡è¯¥å‘½ä»¤å³å¯å®Œæˆæ•°æ®çš„æ“ä½œã€‚</p>
<pre><code class="language-shell">(.venv) âœ  server server --help
Usage: server [OPTIONS] COMMAND [ARGS]...

  This is the commandline interface for server.

Options:
  --config CONFIG  using a path like '/path/to/xxxx.cfg'
  --help           Show this message and exit.

Commands:
  db      Perform database migrations.
  initdb  Create a database and add the first user
  routes  Show the routes for the app.
  run     Run a development server.
  shell   Run a shell in the app context.
(.venv) âœ  server server db --help
Usage: server db [OPTIONS] COMMAND [ARGS]...

  Perform database migrations.

Options:
  --help  Show this message and exit.

Commands:
  branches   Show current branch points
  current    Display the current revision for each database.
  downgrade  Revert to a previous version
  edit       Edit a revision file
  heads      Show current available heads in the script directory
  history    List changeset scripts in chronological order.
  init       Creates a new migration repository.
  merge      Merge two revisions together, creating a new revision file
  migrate    Autogenerate a new revision file (Alias for 'revision...
  revision   Create a new revision file.
  show       Show the revision denoted by the given symbol.
  stamp      'stamp' the revision table with the given revision; don't run...
  upgrade    Upgrade to a later version
</code></pre>
<p>Flask-Migrate çš„ç”¨æ³•å’Œ Alembic ç±»ä¼¼ï¼Œåªæ˜¯å°† alembic æ¢æˆäº†ä½ çš„åº”ç”¨åç§°ã€Œæˆ– flaskã€+ db çš„æ–¹å¼ã€‚</p>
:ET