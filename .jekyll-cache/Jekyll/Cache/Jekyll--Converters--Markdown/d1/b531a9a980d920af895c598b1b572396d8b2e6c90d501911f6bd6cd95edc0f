I"š"<p>Python ä¸­æ“ä½œ Excel çš„æ‰©å±•åº“ä¸»è¦æœ‰ï¼š</p>
<ul>
  <li><a href="https://docs.xlwings.org/zh_CN/latest/quickstart.html"><strong><em>xlwings</em></strong></a>ï¼šåœ¨ GitHub ä¸Šè·å¾—äº† 1.6k çš„ Starã€‚ å¯ç»“åˆ VBA å®ç°å¯¹ Excel çš„ç¼–ç¨‹ã€‚</li>
  <li><a href="https://www.osgeo.cn/openpyxl/tutorial.html"><strong><em>openpyxl</em></strong></a>ï¼šä»£ç æ‰˜ç®¡åœ¨ Bitbucket ä¸Š https://bitbucket.org/openpyxl/openpyxl/src/default/ã€‚ ç®€å•æ˜“ç”¨ï¼ŒåŠŸèƒ½å¹¿æ³›ï¼Œè¿˜æ”¯æŒå›¾è¡¨åŠŸèƒ½ï¼Œä½†æ˜¯å¯¹ VBA æ”¯æŒä¸å¥½ã€‚</li>
  <li><a href="http://pandas.pydata.org/"><strong><em>pandas</em></strong></a>ï¼šåœ¨ GitHub ä¸Šè·å¾—äº† 23.8k çš„ Starã€‚ä¸»è¦ç”¨äºæ•°æ®å¤„ç†ã€‚</li>
  <li><a href="http://pythonexcels.com/python-excel-mini-cookbook/"><strong><em>win32com</em></strong></a>ï¼šåœ¨ GitHub ä¸Šè·å¾—äº† 2.1k  çš„ Starã€‚==ä»…æ”¯æŒ window ç³»ç»Ÿ==</li>
  <li><a href="https://xlsxwriter.readthedocs.io/"><strong><em>xlsxwriter</em></strong></a>ï¼šåœ¨ GitHub ä¸Šè·å¾—äº† 2.1k  çš„ Starã€‚åŒ openpyxl çš„åŠŸèƒ½ç›¸ä¼¼ï¼Œä½†æ˜¯ä¸èƒ½æ‰“å¼€/ä¿®æ”¹å·²æœ‰æ–‡ä»¶ã€‚</li>
  <li><a href="https://pypi.python.org/pypi/xlutils/"><strong><em>xlutils</em></strong></a>ï¼šä»…æ”¯æŒ xls æ–‡ä»¶åŠ excel 2003 åŠä»¥å‰ç‰ˆæœ¬ã€‚</li>
</ul>

<p>æ¯ä¸ªæ‰©å±•åº“çš„åŠŸèƒ½éƒ½æœ‰å…¶ä¾§é‡ç‚¹ï¼Œæ ¹æ®æ‰€éœ€è¦çš„åŠŸèƒ½ï¼Œé€‰æ‹©æ‰€éœ€çš„æ‰©å±•åº“å³å¯ã€‚è¿™é‡Œä¸»è¦ä»‹ç»é€šè¿‡ xlwings å¯¹ Excel æ–‡ä»¶è¿›è¡Œæ“ä½œã€‚</p>

<p>é€‰æ‹© xlwings çš„å‡ ä¸ªåŸå› ï¼š</p>
<ul>
  <li>å·¥ä½œç³»ç»ŸåŒæ—¶å…¼å®¹ Windows å’Œ Mac ï¼Œæ”¯æŒ WPS æ–‡ä»¶ã€‚</li>
  <li>è¯­æ³•ç®€å•ï¼ŒåŸºæœ¬ä¸Šç”¨è¿‡ä¸€æ¬¡å°±ä¼šè®°ä½ã€‚</li>
  <li>åŠŸèƒ½é½å…¨ï¼Œæ”¯æŒæ–°å»ºã€æ‰“å¼€ã€ä¿®æ”¹ã€ä¿å­˜ç­‰ç­‰ã€‚</li>
  <li>å¯ä»¥è°ƒç”¨å·²æœ‰çš„ VBA ç¨‹åºï¼ˆè¿™ä¸ªæš‚æ—¶æˆ‘è¿˜æ²¡æœ‰ç”¨åˆ°ï¼‰ã€‚</li>
</ul>

<blockquote>
  <p>é€šè¿‡ <code>pip install xlwings</code> æ¥å®‰è£… xlwingsï¼Œå½“å‰æœ€æ–°ç‰ˆæœ¬æ˜¯ 0.18.0</p>
</blockquote>

<p>xlwings çš„å£å·æ˜¯ï¼šâ€==è®© Excel è·‘çš„é£å¿«==â€ï¼Œæ„Ÿè§‰æœ‰ç‚¹æ„æ€ã€‚å®ƒæ˜¯åŸºäº BSD-licensed(ä¼¯å…‹åˆ©è½¯ä»¶å‘è¡Œç‰ˆè®¸å¯åè®®) çš„Pythonåº“ï¼Œå®ƒè®©Pythonå’ŒExcelä¹‹é—´çš„ç›¸äº’è°ƒç”¨å˜å¾—æ›´åŠ å®¹æ˜“ã€‚</p>

<h4 id="æ–°å»ºæ–‡ä»¶">æ–°å»ºæ–‡ä»¶</h4>
<p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥æ–°å»ºä¸€ä¸ª Excel æ–‡ä»¶</p>
<pre><code class="language-python">import xlwings as xw

wb = xw.Book() # or xw.books()
wb.save('test.xlsx')
</code></pre>
<p>æˆ–å¦ä¸€ç§æ–¹å¼</p>
<pre><code class="language-python">import xlwings as xw

app = xw.App()

try:
    wb = app.books.add()
    wb.save('test.xlsx')
    wa.close()
except Exception as err:
    print(err)
app.quite()
</code></pre>

<h4 id="æ‰“å¼€å·²æœ‰æ–‡ä»¶">æ‰“å¼€å·²æœ‰æ–‡ä»¶</h4>
<p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥æ‰“å¼€ä¸€ä¸ªå·²æœ‰æ–‡ä»¶</p>
<pre><code class="language-pyhon">import xlwings as xw

wb = xw.Book('test.xlsx') # ro xw.bookx('test.xlsx')
</code></pre>
<blockquote>
  <p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ä½¿ç”¨çš„ç›¸å¯¹è·¯å¾„ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„ã€‚
å½“åœ¨ windows ä¸Šä½¿ç”¨æ—¶ï¼Œæ³¨æ„ â€œ" çš„è½¬ä¹‰é—®é¢˜ï¼Œæ¨èç›´æ¥åœ¨è·¯å¾„å­—ç¬¦ä¸²ä¸ŠåŠ  r ã€Œrâ€™g:\python\test.xlsxã€
ã€‚</p>
</blockquote>

<p>ä¹Ÿå¯ä»¥ä½¿ç”¨å¦å¤–ä¸€ç§æ–¹å¼</p>
<pre><code class="language-python">import xlwings as xw

app = xw.App()
path = r'g:\python\test.xlsx
try:
    wb = app.books.open(path)
    wb.save()
    wa.close()
except Exception as err:
    print(err)
app.quite()
</code></pre>

<h4 id="è¯»å–å¹¶ä¿®æ”¹æ–‡ä»¶å†…å®¹">è¯»å–å¹¶ä¿®æ”¹æ–‡ä»¶å†…å®¹</h4>
<p>Excel æ–‡ä»¶æ˜¯ç”±ä¸€ä¸ªä¸ªå·¥ä½œè¡¨ç»„æˆçš„ï¼Œè¦æƒ³æ“ä½œæ–‡ä»¶å†…å®¹ï¼Œéœ€è¦å…ˆæ‰“å¼€å·¥ä½œè¡¨ã€Œsheetã€ï¼Œæ‰“å¼€ sheet ç”±ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š</p>
<pre><code class="language-python">sheet = wb.sheets[0]       #ä¸‹æ ‡å®šä½æ‰“å¼€ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨
sheet = wb.sheets['test']  #æ‰“å¼€åå­—ä¸º test çš„å·¥ä½œè¡¨
sheet = wb.sheets.active   #æ‰“å¼€å½“å‰æ¿€æ´»çš„å·¥ä½œè¡¨
</code></pre>
<p>å·¥ä½œè¡¨æ˜¯ç”±ä¸€ä¸ªä¸ªå•å…ƒæ ¼ç»„æˆçš„ï¼Œæœ€ç»ˆæˆ‘ä»¬æ“ä½œçš„æ˜¯ä¸€ä¸ªä¸ªå•å…ƒæ ¼ä¸­çš„æ•°æ®ï¼Œæ¥ä¸‹æ¥ä¸€å—æ¥çœ‹ä¸‹å•å…ƒçš„æ•°æ®æ“ä½œã€‚</p>
<pre><code class="language-python">sheet = wb.sheets[0]
sheet.range('A1').value = 1     #å‘ A1 å•å…ƒæ ¼å†™å…¥ 1
print(sheet.range('A1').value)  #è¯»å– A1 å•å…ƒæ ¼ä¸­çš„å†…å®¹
# 1.0
</code></pre>
<blockquote>
  <p>æ ¹æ®å•å…ƒæ ¼é‡Œé¢å­˜å‚¨çš„æ˜¯æ•°å­—ã€å­—ç¬¦ä¸²ã€ç©ºç™½è¿˜æ˜¯æ—¥æœŸï¼Œè¿”å›çš„ python å¯¹è±¡ç±»å‹åˆ†åˆ«æ˜¯ float, unicode, None æˆ– datetime</p>
</blockquote>

<p>å‰é¢æ“ä½œçš„æ˜¯å•ä¸ªå•å…ƒæ ¼ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥æ“ä½œä¸€è¡Œæˆ–ä¸€åˆ—</p>
<pre><code class="language-python">sheet.range('A1').value = [1, 2, 3, 4, 5]  #å‘ A1:E1 å†™å…¥æ•°æ®
print(sheet.range('A1:E1').value)          #è¯»å– A1:E1 çš„æ•°æ®
# [1.0, 2.0, 3.0, 4.0, 5.0]
</code></pre>
<p><code>sheet.range('xx').value</code> é»˜è®¤æŒ‰è¡Œå†™å…¥æ•°æ®ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬æƒ³è¦æŒ‰åˆ—å†™å…¥æ•°æ®æ€ä¹ˆåŠï¼ŒæŒ‰åˆ—å†™å…¥æ•°æ®æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ³•ã€‚</p>
<pre><code class="language-python">sheet.range('A1').value = [[1],[2],[3],[4],[5]]
print(sheet.range('A1:A5').value) 
# [1.0, 2.0, 3.0, 4.0, 5.0]
# æˆ–è€…ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•
sheet.range('A1').options(transpose=True).value = [6, 7, 8, 9, 10]
print(sheet.range('A1:A5').value) 
# [6.0, 7.0, 8.0, 9.0, 10.0]
</code></pre>
<p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ“ä½œæ•°æ®è¡¨å†™å…¥çš„éƒ½æ˜¯å¤šè¡Œçš„æ•°æ®ï¼Œç”±ä¸Šé¢çš„åŸºç¡€å®é™…ä¸Šå¤šè¡Œæ•°æ®å°±æ˜¯ä¸€ä¸ªäºŒç»´çš„åˆ—è¡¨ï¼Œä¸€æ¬¡å†™å…¥å’Œè¯»å–å¤šè¡Œçš„æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<pre><code class="language-python">sheet.range('A1').value = [['Foo 1', 'Foo 2', 'Foo 3'], [10, 20, 30]]
print(sheet.range('A1:C2').value)
# [['Foo 1', 'Foo 2', 'Foo 3'], [10.0, 20.0, 30.0]]
print(sheet.range((1, 1), (2, 3)).value)
# [['Foo 1', 'Foo 2', 'Foo 3'], [10.0, 20.0, 30.0]]
</code></pre>
<p>ä½†æ˜¯ xlwings è¿˜æä¾›äº†å¦å¤–ä¸€ç§æ›´åŠ æ–¹ä¾¿çš„æ–¹å¼æ¥æ“ä½œä¸€ä¸ªåŒºåŸŸå—ï¼Œé€šè¿‡ expand æˆ– options ä¸­çš„ expand å‚æ•°ï¼Œexpand ä½¿ç”¨çš„æ˜¯å½“å‰å·²è·å–çš„åŒºåŸŸå¯¹è±¡ï¼Œè€Œ options ä¸­çš„ expand å‚æ•°åœ¨æ¡ç”¨æ—¶æ‰è®¡ç®—åŒºåŸŸå¯¹è±¡ï¼Œæ¨èä½¿ç”¨ options ä¸­çš„ expand å‚æ•°ï¼Œæ˜¯ä½ å¯ä»¥åœ¨æ›´æ”¹åŒºåŸŸååŠæ—¶è·å–åŒºåŸŸçš„å˜åŒ–ã€‚ä¸‹é¢çš„ä»£ç ï¼Œå¯ä»¥æ¸…æ¥šçš„è¡¨è¾¾ä¸¤ç§æ–¹å¼çš„ä¸åŒã€‚</p>
<pre><code class="language-python">sheet.range('A1').value = [[1,2], [3,4]]
rng1 = sheet.range('A1').expand('table') 
rng2 = sheet.range('A1').options(expand='table')
print(rng1.value)
# [[1.0, 2.0], [3.0, 4.0]]
print(rng2.value)
# [[1.0, 2.0], [3.0, 4.0]]
sheet.range('A3').value = [5, 6]
print(rng1.value)
# [[1.0, 2.0], [3.0, 4.0]]
print(rng2.value)
# [[1.0, 2.0], [3.0, 4.0], [5.0, 6.0]]
</code></pre>

<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­ï¼š</p>
<pre><code class="language-python">import xlwings as xw

wb = xw.Book()
sheet = wb.sheets[0]
sheet.range('A1').value = [1, 2, 3, 4, 5]
sheet.range('A2').value = ['a', 'b', 'c']
rng1 = sheet.range('a1').expand('table')
val = rng1.value
print(val)

for i in val:
    if isinstance(i, list):
        for j in i:
            print('value=%s, type=%s' %(str(j), type(j)))
    else:
     print(i)

count = rng1.columns.count
sum = 0
value = sheet[0, :count].value
for i in sheet[0, :count].value:
    sum = sum + i;
value.append(sum)
sheet.range('A1').value = value
rng2 = sheet.range('A1').options(expand='table')
print(rng2.value)
print(rng1.value)

wb.save('test.xlsx')
wb.close()
</code></pre>

<p>è¿è¡Œä»¥åçš„è¾“å…¥ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code class="language-shell">[[1.0, 2.0, 3.0, 4.0, 5.0], ['a', 'b', 'c', None, None]]
value=1.0, type=&lt;class 'float'&gt;
value=2.0, type=&lt;class 'float'&gt;
value=3.0, type=&lt;class 'float'&gt;
value=4.0, type=&lt;class 'float'&gt;
value=5.0, type=&lt;class 'float'&gt;
value=a, type=&lt;class 'str'&gt;
value=b, type=&lt;class 'str'&gt;
value=c, type=&lt;class 'str'&gt;
value=None, type=&lt;class 'NoneType'&gt;
value=None, type=&lt;class 'NoneType'&gt;
[[1.0, 2.0, 3.0, 4.0, 5.0, 15.0], ['a', 'b', 'c', None, None, None]]
[[1.0, 2.0, 3.0, 4.0, 5.0], ['a', 'b', 'c', None, None]]
</code></pre>
<p>ç¨‹åºè¿è¡Œå®Œæˆåï¼Œåœ¨å½“å‰æ–‡ä»¶ä¸‹å°†çœ‹åˆ°ä¸€ä¸ª test.xlsx çš„ Excel æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>

<h4 id="å…¶ä»–">å…¶ä»–</h4>
<ul>
  <li>æ¸…é™¤å•å…ƒæ ¼å†…å®¹å’Œæ ¼å¼ <code>sheet.range('A1').clear()</code></li>
  <li>å•å…ƒæ ¼çš„åˆ—æ ‡ <code>sheet.range('A1').column</code></li>
  <li>å•å…ƒæ ¼çš„è¡Œæ ‡ <code>sheet.range('A1').row</code></li>
  <li>å•å…ƒæ ¼çš„è¡Œé«˜ <code>sheet.range('A1').row_height</code></li>
  <li>å•å…ƒæ ¼çš„åˆ—å®½ <code>sheet.range('A1').column_width</code></li>
  <li>åˆ—å®½è‡ªé€‚åº” <code>sheet.range('A1').columns.autofit()</code></li>
  <li>è¡Œé«˜è‡ªé€‚åº” <code>sheet.range('A1').rows.autofit()</code></li>
  <li>å•å…ƒæ ¼èƒŒæ™¯è‰²(RGB) <code>sheet.range('A1').color = (34,139,34)</code></li>
  <li>æ¸…é™¤å•å…ƒæ ¼é¢œè‰² <code>sheet.range('A1').color = None</code></li>
  <li>è¾“å…¥å…¬å¼ï¼Œç›¸åº”å•å…ƒæ ¼ä¼šå‡ºç°è®¡ç®—ç»“æœ <code>sheet.range('A1').formula='=SUM(A1:E1)</code></li>
  <li>è·å–å•å…ƒæ ¼å…¬å¼ <code>sheet.range('A1').formula_array</code></li>
</ul>
:ET